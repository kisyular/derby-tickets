<!-- Login Attempts AJAX Content -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-sign-in-alt"></i> Login Attempts
        </h3>
        <div class="card-tools">
          <button class="btn btn-tool" onclick="location.reload()">
            <i class="fas fa-sync-alt"></i> Refresh
          </button>
        </div>
      </div>
      <div class="card-body table-responsive p-0">
        {% if attempts %}
        <table class="table table-hover text-nowrap">
          <thead>
            <tr>
              <th>Time</th>
              <th>Username</th>
              <th>IP Address</th>
              <th>Status</th>
              <th>Suspicious</th>
              <th>User Agent</th>
            </tr>
          </thead>
          <tbody>
            {% for attempt in attempts %}
            <tr>
              <td>
                <small>{{ attempt.timestamp|date:"M d, H:i" }}</small>
              </td>
              <td>{{ attempt.username|default:"-" }}</td>
              <td>{{ attempt.ip_address|default:"-" }}</td>
              <td>
                {% if attempt.status == 'SUCCESS' %}
                <span class="badge badge-success">{{ attempt.status }}</span>
                {% elif attempt.status == 'FAILED' %}
                <span class="badge badge-danger">{{ attempt.status }}</span>
                {% elif attempt.status == 'BLOCKED' %}
                <span class="badge badge-warning">{{ attempt.status }}</span>
                {% else %}
                <span class="badge badge-secondary">{{ attempt.status }}</span>
                {% endif %}
              </td>
              <td>
                {% if attempt.is_suspicious %}
                <span class="badge badge-danger">
                  <i class="fas fa-exclamation-triangle"></i> Yes
                </span>
                {% else %}
                <span class="badge badge-success">No</span>
                {% endif %}
              </td>
              <td>
                <small
                  >{{ attempt.user_agent|truncatechars:50|default:"-" }}</small
                >
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
        <div class="p-4 text-center">
          <i class="fas fa-sign-in-alt fa-3x text-muted mb-3"></i>
          <p class="text-muted">
            No login attempts found for the selected time period.
          </p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
